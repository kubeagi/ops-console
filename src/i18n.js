const i18nConfig = {
  'en-US': {
      'i18n-1gikmooh': 'Details',
      'i18n-2b53hns8': 'Processing of data',
      'i18n-2ejg9q5l': 'Add dataset',
      'i18n-38tkeb1r': 'Data source management',
      'i18n-3k0nxm6h': 'The import was successful',
      'i18n-4ebt9mj3': 'raw data',
      'i18n-5bu583cw': 'Release',
      'i18n-5djmpfvu': 'Dataset management',
      'i18n-6r57uk2w': 'data processing',
      'i18n-8f4bzjjd': 'The connection is abnormal',
      'i18n-9plmyzo5': 'Importing',
      'i18n-af4xea8m': 'Please select the type',
      'i18n-e9onsolp': 'raw data',
      'i18n-eog0s8xc': 'Data ingestion',
      'i18n-glavn95l': 'Please enter a name for the data source',
      'i18n-hp37vpeo': 'Please enter the data source name to search',
      'i18n-jskgqh8o': 'flushed',
      'i18n-k7qioby7': 'Dataset version details',
      'i18n-ks28cpqo': 'data type',
      'i18n-lzsiaffa': 'Dataset version details',
      'i18n-m2zjlilo': 'Data sources',
      'i18n-mh5ck17f': 'Import data',
      'i18n-o0qitjur': 'Please enter a description',
      'i18n-p5qipded': 'Application scenarios',
      'i18n-p7mextst': 'state',
      'i18n-qahl1me8': 'The connection is successful',
      'i18n-qi5varhn': 'A dataset has been added',
      'i18n-qiakd7cu': 'The name of the data',
      'i18n-qjodl1nn': 'Creation time',
      'i18n-rd3x3m3s': 'Add dataset',
      'i18n-sg7nu8tx': 'Created by',
      'i18n-str3pnrc': 'edit',
      'i18n-tr55yns8': 'The name of the data source',
      'i18n-txt5kh4m': 'description',
      'i18n-uag94ndq': 'Updated',
      'i18n-ueslu0a9': 'A new data source is added',
      'i18n-vce3sfm7': 'Please enter the dataset name to search',
      'i18n-wgpt60zj': 'New version',
      'i18n-wourf2xg': 'return',
      'i18n-xbgo4no6': 'All versions',
      'i18n-z0idrepg': 'Delete',
      'i18n-02scypvh': 'Only .csv files are supported;',
      'i18n-0hlfubp3': 'Dataset configuration',
      'i18n-1i46nz7w': 'Delete data source',
      'i18n-1mg6qw38': 'No more than 2G,',
      'i18n-1sgb2qhp': 'The dataset was added',
      'i18n-2ncs5xaw': 'Service Providers',
      'i18n-3avsorb4': 'finance',
      'i18n-3kxctf9p': 'text',
      'i18n-3m6syxvd': 'Please enter a description of the version',
      'i18n-45qn5g3j': 'Version description',
      'i18n-4hvq7ssv': 'ID',
      'i18n-4sbaoiyr': 'Image',
      'i18n-516o6p6k': 'Video',
      'i18n-53smn5la': 'Click / drag and drop the file to this area to upload',
      'i18n-585k83dk': 'The dataset name consists of 0 ~ 50 characters',
      'i18n-5h6srqet': 'Confirm delete data source',
      'i18n-5j8juy3c': 'A dataset has been added',
      'i18n-5p155qf6': 'Created by',
      'i18n-6gwgta6g': 'Please select a file type',
      'i18n-6h2qbk6l': 'Token',
      'i18n-72kqkgmc': 'Failed to add a new dataset',
      'i18n-7y2oh4lj': 'Application scenarios',
      'i18n-82tsjj5m': 'law',
      'i18n-8vmpttzl': 'Edit data source',
      'i18n-930782xc': 'No more than 20',
      'i18n-9qfjn6yy': 'Please enter a dataset name',
      'i18n-bouyq94t': 'Single file size',
      'i18n-bwjy26tq': 'Service Specifications',
      'i18n-caequar5': 'Dataset type',
      'i18n-g2z2389b': 'Only .txt, .doc, .docx, .pdf, .md files are supported;',
      'i18n-g9s3q1i6': 'Dataset name',
      'i18n-glkas5dt': 'Service Providers',
      'i18n-hrtg7fkn': 'educate',
      'i18n-idhz6qcw': 'The version description consists of 0 ~ 200 characters',
      'i18n-jgb2t9hr': 'Upload the file',
      'i18n-k56nh13q': 'other',
      'i18n-l6bbbjcm': 'QA text',
      'i18n-ljfukqf4': 'Created by',
      'i18n-mazlme9u': 'energy',
      'i18n-mi1s7ntp': 'Dataset version',
      'i18n-mq4to9og': 'Are you sure',
      'i18n-n4a25wxc': 'API address',
      'i18n-pycp6iku': 'App Center',
      'i18n-q7wryol4': 'Please select an application scenario',
      'i18n-qw5ig9gm': 'Application scenarios',
      'i18n-tg2scz4v': 'Cancel',
      'i18n-tp1yr7fn': 'The number of files uploaded at a time',
      'i18n-uwszai5e': 'Normal text',
      'i18n-v57sro4s': 'Service address',
      'i18n-vffw3xac': 'Details',
      'i18n-vgl4ncps': 'model',
      'i18n-vpux924a': 'Model type',
      'i18n-w9nvxdg4': 'Creation time',
      'i18n-wmit27v8': 'model',
      'i18n-w9rn8mqn': 'The dataset name is duplicated',
      'i18n-xddfp5fl': 'Please select a dataset type',
      'i18n-y2kflhdo': 'file type',
      'i18n-ylt7jmxo': 'Spaces are not supported',
      'i18n-yrc22hwt': 'medical',
      'i18n-z8fujdli': 'Associate model app',
      'i18n-zpw49ds4': 'technology',
      'i18n-2bh18kta': 'Model Service Providers',
      'i18n-46sag7fe': 'A local model service is added',
      'i18n-5bh3fx4n': 'On-premises model service',
      'i18n-6fd3evtc': 'Unknown',
      'i18n-7c7ys57v': 'Please select a model',
      'i18n-7gis9gw2': 'Model Service Providers',
      'i18n-877dpham': 'On-premises model service',
      'i18n-93a56z3w': 'External Model Service',
      'i18n-9sbolidp': 'Please enter a model service provider',
      'i18n-a15577e2': 'One',
      'i18n-a268pjhk': 'Model service configuration',
      'i18n-aayy2k5c': 'External Model Service',
      'i18n-b88302dd': 'Please select a model version',
      'i18n-bjvi1qbj': 'Hover me',
      'i18n-c7rmoe8b': 'nucleus',
      'i18n-cd20aykf': 'Please enter a description',
      'i18n-chz7ktkd': 'Deploying',
      'i18n-cqapbnun': 'The name of the model service',
      'i18n-d43b7hfv': 'A model service is added',
      'i18n-ehov7ype': 'flushed',
      'i18n-f591ezbf': 'Please enter the model service name to search',
      'i18n-fsie7kyx': 'model',
      'i18n-guknewzm': 'Please enter a model service name',
      'i18n-h3x32uiv': 'One Hundred Twenty Three',
      'i18n-h7h5as79': 'Token',
      'i18n-il4b7wme': 'description',
      'i18n-iljnr6om': 'edit',
      'i18n-itjueia6': 'LLM',
      'i18n-jch93moe': 'flushed',
      'i18n-k3ur8ozb': 'input box',
      'i18n-kj2gsaqa': 'flushed',
      'i18n-kqg9mfj9': 'Embedding',
      'i18n-m9ort1jb': 'description',
      'i18n-n55cj6ks': 'Service Specifications',
      'i18n-po894cid': 'The address of the model service',
      'i18n-qpx0jbpu': 'flushed',
      'i18n-sgqsx0ua': 'screenwriter',
      'i18n-t06rg1nj': 'Model services',
      'i18n-u0etzjrs': 'CPU',
      'i18n-vod7txy9': 'flushed',
      'i18n-vy7xpbxn': 'Line',
      'i18n-w36qzovb': 'Please enter the model service address',
      'i18n-wrf069l1': 'Please enter a description',
      'i18n-y8g91nx6': 'Model Service Providers',
      'i18n-ynjrbhln': 'Model service type',
      'i18n-z12hcv6s': 'Test the link',
      'i18n-4bisav57': 'API',
      'i18n-8cjf8cxq': 'Object storage',
      'i18n-9odw2n6l': 'Local upload',
      'i18n-ia3gjpq5': 'The new data source is successful',
      'i18n-kktx1hle': 'MongoDB',
      'i18n-p20wuevb': 'Failed to add a new data source',
      'i18n-sah3nlrl': 'Failed to edit the data source',
      'i18n-sanitrjl': 'MySQL',
      'i18n-tjlmmaei': 'File storage',
      'i18n-tz6dwud2': 'The data source was edited successfully',
      'i18n-vf1xe64m': 'The data source was deleted',
      'i18n-yc0jhxgr': 'Failed to delete the data source'
  },
  'zh-CN': {
      'i18n-1gikmooh': '详细信息',
      'i18n-2b53hns8': '处理数据',
      'i18n-2ejg9q5l': '新增数据集',
      'i18n-38tkeb1r': '数据源管理',
      'i18n-3k0nxm6h': '导入成功',
      'i18n-4ebt9mj3': '原始数据',
      'i18n-5bu583cw': '发布',
      'i18n-5djmpfvu': '数据集管理',
      'i18n-6r57uk2w': '数据处理',
      'i18n-8f4bzjjd': '连接异常',
      'i18n-9plmyzo5': '导入中',
      'i18n-af4xea8m': '请选择类型',
      'i18n-e9onsolp': '原始数据',
      'i18n-eog0s8xc': '数据接入',
      'i18n-glavn95l': '请输入数据源名称',
      'i18n-hp37vpeo': '请输入数据源名称搜索',
      'i18n-jskgqh8o': '刷新',
      'i18n-k7qioby7': '数据集版本详情',
      'i18n-ks28cpqo': '数据类型',
      'i18n-lzsiaffa': '数据集版本详情',
      'i18n-m2zjlilo': '数据源',
      'i18n-mh5ck17f': '导入数据',
      'i18n-o0qitjur': '请输入描述',
      'i18n-p5qipded': '应用场景',
      'i18n-p7mextst': '状态',
      'i18n-qahl1me8': '连接成功',
      'i18n-qi5varhn': '新增数据集',
      'i18n-qiakd7cu': '数据名称',
      'i18n-qjodl1nn': '创建时间',
      'i18n-rd3x3m3s': '新增数据集',
      'i18n-sg7nu8tx': '创建者',
      'i18n-str3pnrc': '编辑',
      'i18n-tr55yns8': '数据源名称',
      'i18n-txt5kh4m': '描述',
      'i18n-uag94ndq': '更新时间',
      'i18n-ueslu0a9': '新增数据源',
      'i18n-vce3sfm7': '请输入数据集名称搜索',
      'i18n-wgpt60zj': '新增版本',
      'i18n-wourf2xg': '返回',
      'i18n-xbgo4no6': '所有版本',
      'i18n-z0idrepg': '删除',
      'i18n-02scypvh': '仅支持  .csv 文件；',
      'i18n-0hlfubp3': '数据集配置',
      'i18n-1i46nz7w': '删除数据源',
      'i18n-1mg6qw38': '不超过 2G，',
      'i18n-1sgb2qhp': '新增数据集成功',
      'i18n-2ncs5xaw': '服务供应商',
      'i18n-3avsorb4': '金融',
      'i18n-3kxctf9p': '文本',
      'i18n-3m6syxvd': '请输入版本描述',
      'i18n-45qn5g3j': '版本描述',
      'i18n-4hvq7ssv': 'ID',
      'i18n-4sbaoiyr': '图片',
      'i18n-516o6p6k': '视频',
      'i18n-53smn5la': '点击 / 拖拽文件到此区域上传',
      'i18n-585k83dk': '数据集名称由 0 ~ 50 字符组成',
      'i18n-5h6srqet': '确定删除数据源',
      'i18n-5j8juy3c': '新增数据集',
      'i18n-5p155qf6': '创建者',
      'i18n-6gwgta6g': '请选择文件类型',
      'i18n-6h2qbk6l': 'Token',
      'i18n-72kqkgmc': '新增数据集失败',
      'i18n-7y2oh4lj': '应用场景',
      'i18n-82tsjj5m': '法律',
      'i18n-8vmpttzl': '编辑数据源',
      'i18n-930782xc': '不超过 20个',
      'i18n-9qfjn6yy': '请输入数据集名称',
      'i18n-bouyq94t': '单文件大小',
      'i18n-bwjy26tq': '服务规格',
      'i18n-caequar5': '数据集类型',
      'i18n-g2z2389b': '仅支持 .txt,.doc,.docx,.pdf,.md 文件；',
      'i18n-g9s3q1i6': '数据集名称',
      'i18n-glkas5dt': '服务供应商',
      'i18n-hrtg7fkn': '教育',
      'i18n-idhz6qcw': '版本描述由 0 ~ 200 字符组成',
      'i18n-jgb2t9hr': '上传文件',
      'i18n-k56nh13q': '其他',
      'i18n-l6bbbjcm': 'QA 文本',
      'i18n-ljfukqf4': '创建者',
      'i18n-mazlme9u': '能源',
      'i18n-mi1s7ntp': '数据集版本',
      'i18n-mq4to9og': '确定',
      'i18n-n4a25wxc': 'API地址',
      'i18n-pycp6iku': '应用场景',
      'i18n-q7wryol4': '请选择应用场景',
      'i18n-qw5ig9gm': '应用场景',
      'i18n-tg2scz4v': '取消',
      'i18n-tp1yr7fn': '单次上传文件数量',
      'i18n-uwszai5e': '普通文本',
      'i18n-v57sro4s': '服务地址',
      'i18n-vffw3xac': '详细信息',
      'i18n-vgl4ncps': '模型',
      'i18n-vpux924a': '模型类型',
      'i18n-w9nvxdg4': '创建时间',
      'i18n-wmit27v8': '模型',
      'i18n-w9rn8mqn': '数据集名称重复',
      'i18n-xddfp5fl': '请选择数据集类型',
      'i18n-y2kflhdo': '文件类型',
      'i18n-ylt7jmxo': '不支持输入空格',
      'i18n-yrc22hwt': '医疗',
      'i18n-z8fujdli': '关联模型应用',
      'i18n-zpw49ds4': '科技',
      'i18n-2bh18kta': '模型服务供应商',
      'i18n-46sag7fe': '新增本地模型服务',
      'i18n-5bh3fx4n': '本地模型服务',
      'i18n-6fd3evtc': '未知',
      'i18n-7c7ys57v': '请选择模型',
      'i18n-7gis9gw2': '模型服务供应商',
      'i18n-877dpham': '本地模型服务',
      'i18n-93a56z3w': '外部模型服务',
      'i18n-9sbolidp': '请输入模型服务供应商',
      'i18n-a15577e2': '',
      'i18n-a268pjhk': '模型服务配置',
      'i18n-aayy2k5c': '外部模型服务',
      'i18n-b88302dd': '请选择模型版本',
      'i18n-bjvi1qbj': 'Hover me',
      'i18n-c7rmoe8b': '核',
      'i18n-cd20aykf': '请输入描述',
      'i18n-chz7ktkd': '部署中',
      'i18n-cqapbnun': '模型服务名称',
      'i18n-d43b7hfv': '新增模型服务',
      'i18n-ehov7ype': '刷新',
      'i18n-f591ezbf': '请输入模型服务名称搜索',
      'i18n-fsie7kyx': '模型',
      'i18n-guknewzm': '请输入模型服务名称',
      'i18n-h3x32uiv': '',
      'i18n-h7h5as79': 'Token',
      'i18n-il4b7wme': '描述',
      'i18n-iljnr6om': '编辑',
      'i18n-itjueia6': 'LLM',
      'i18n-jch93moe': '刷新',
      'i18n-k3ur8ozb': '',
      'i18n-kj2gsaqa': '刷新',
      'i18n-kqg9mfj9': 'Embedding',
      'i18n-m9ort1jb': '描述',
      'i18n-n55cj6ks': '服务规格',
      'i18n-po894cid': '模型服务地址',
      'i18n-qpx0jbpu': '刷新',
      'i18n-sgqsx0ua': '',
      'i18n-t06rg1nj': '模型服务',
      'i18n-u0etzjrs': '',
      'i18n-vod7txy9': '刷新',
      'i18n-vy7xpbxn': '下线',
      'i18n-w36qzovb': '请输入模型服务地址',
      'i18n-wrf069l1': '请输入描述',
      'i18n-y8g91nx6': '模型服务供应商',
      'i18n-ynjrbhln': '模型服务类型',
      'i18n-z12hcv6s': '测试链接',
      'i18n-4bisav57': 'API',
      'i18n-8cjf8cxq': '对象存储',
      'i18n-9odw2n6l': '本地上传',
      'i18n-ia3gjpq5': '新增数据源成功',
      'i18n-kktx1hle': 'MongoDB',
      'i18n-p20wuevb': '新增数据源失败',
      'i18n-sah3nlrl': '编辑数据源失败',
      'i18n-sanitrjl': 'MySQL',
      'i18n-tjlmmaei': '文件存储',
      'i18n-tz6dwud2': '编辑数据源成功',
      'i18n-vf1xe64m': '删除数据源成功',
      'i18n-yc0jhxgr': '删除数据源失败'
  }
};

const LOCALE_KEY = 'intl_locale';
let locale = window.localStorage.getItem(LOCALE_KEY);
if (!locale) {
  locale =
    typeof navigator === 'object' && typeof navigator.language === 'string'
      ? navigator.language
      : 'zh-CN';
}
if (locale.startsWith('en')) {
  locale = 'en-US';
} else {
  locale = 'zh-CN';
}

const getLocale = () => locale;

const setLocale = target => {
  locale = target;
  window.localStorage.setItem(LOCALE_KEY, target);
};

const isEmptyVariables = variables =>
  (Array.isArray(variables) && variables.length === 0) ||
  (typeof variables === 'object' && (!variables || Object.keys(variables).length === 0));

// 按低代码规范里面的要求进行变量替换
const format = (msg, variables) =>
  typeof msg === 'string'
    ? msg.replace(/\$?\{(\w+)\}/g, (match, key) => variables?.[key] ?? '')
    : msg;

const i18nFormat = ({ id, defaultMessage, fallback }, variables) => {
  const msg =
    i18nConfig[locale]?.[id] ?? i18nConfig[locale.replace('-', '_')]?.[id] ?? defaultMessage;
  if (msg == null) {
    console.warn('[i18n]: unknown message id: %o (locale=%o)', id, locale);
    return fallback === undefined ? `${id}` : fallback;
  }

  return format(msg, variables);
};

const i18n = (id, params) => {
  return i18nFormat({ id }, params);
};

// 将国际化的一些方法注入到目标对象&上下文中
const _inject2 = target => {
  target.i18n = i18n;
  target.getLocale = getLocale;
  target.setLocale = locale => {
    setLocale(locale);
    target.forceUpdate();
  };
  target._i18nText = t => {
    // 优先取直接传过来的语料
    const localMsg = t[locale] ?? t[String(locale).replace('-', '_')];
    if (localMsg != null) {
      return format(localMsg, t.params);
    }

    // 其次用项目级别的
    const projectMsg = i18nFormat({ id: t.key, fallback: null }, t.params);
    if (projectMsg != null) {
      return projectMsg;
    }

    // 兜底用 use 指定的或默认语言的
    return format(t[t.use || 'zh-CN'] ?? t.en_US, t.params);
  };

  // 注入到上下文中去
  if (target._context && target._context !== target) {
    Object.assign(target._context, {
      i18n,
      getLocale,
      setLocale: target.setLocale,
    });
  }
};

export { getLocale, setLocale, i18n, i18nFormat, _inject2 };
